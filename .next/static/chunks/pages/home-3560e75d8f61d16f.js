(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{8946:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return n(3876)}])},3876:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var r=n(5893),o=n(4051),a=n.n(o),i=n(7294),u=n(9669),c=n.n(u),s=n(7120),l=n(1349),d=n.n(l),f=n(1403),p=n(3321);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(c){u=!0,o=c}finally{try{i||null==n.return||n.return()}finally{if(u)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var g=new(d())({bitRate:128}),m=function(e){var t=(0,i.useState)(null),n=t[0],o=t[1],a=(0,i.useState)(null),u=a[0],c=a[1],s=(0,i.useState)(!1),l=s[0],d=s[1];return(0,i.useEffect)((function(){navigator.getUserMedia({audio:!0},(function(){console.log("Permission Granted"),o(!1)}),(function(){console.log("Permission Denied"),o(!0)}))}),[]),(0,r.jsx)("div",{className:f.Recorder,children:(0,r.jsxs)("header",{className:f.header,children:[(0,r.jsx)(p.Z,{variant:"contained",type:"button",onClick:function(){n?console.log("Permission Denied"):(e.setIsRecordingStart(!0),g.start().then((function(){d(!0)})).catch((function(e){return console.error(e)})))},disabled:l,children:"Record"}),(0,r.jsx)(p.Z,{variant:"contained",type:"button",onClick:function(){g.stop().getMp3().then((function(t){var n=v(t,2),r=n[0],o=n[1];console.log(r);var a=new File(r,"audio.mp3",{type:o.type,lastModified:Date.now()});e.setAudio(a);var i=URL.createObjectURL(o);c(i),d(!1)})).catch((function(e){return console.log(e)}))},disabled:!l,children:"Stop"}),(0,r.jsx)("audio",{src:u,controls:"controls"})]})})},x=n(5113),y=n(8862),_=n(1163);function b(e,t,n,r,o,a,i){try{var u=e[a](i),c=u.value}catch(s){return void n(s)}u.done?t(c):Promise.resolve(c).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){b(a,r,o,i,u,"next",e)}function u(e){b(a,r,o,i,u,"throw",e)}i(void 0)}))}}var w=function(){var e,t=(0,i.useState)(null),n=t[0],o=t[1],u=(0,i.useState)(),l=u[0],d=u[1],f=(0,i.useState)([]),h=f[0],v=f[1],g=(0,i.useState)(),b=g[0],w=g[1],j=(0,i.useState)(!1),R=j[0],k=j[1],A=(0,i.useState)(),E=A[0],U=A[1],I=(0,i.useState)(),Z=I[0],D=I[1],N=(0,_.useRouter)(),P=function(){var e=S(a().mark((function e(t){var r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),(r=new FormData).append("files",n),r.append("refId","1"),r.append("ref","plugin::users-permissions.user"),r.append("field","cover"),(o=localStorage.getItem("token"))||N.push("/login"),e.next=10,c().post("".concat("http://localhost:8082","/api/upload"),r,{headers:{Authorization:"Bearer ".concat(o)}});case 10:200===e.sent.status?alert("File uploaded successfully"):(localStorage.removeItem("token"),N.push("/login"));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){var e=localStorage.getItem("token");e||N.push("/login");var t=function(){var t=S(a().mark((function t(){var n,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c().get("".concat("http://localhost:8082","/api/users/me"),{headers:{Authorization:"Bearer ".concat(e)}});case 3:200===(n=t.sent).status&&(r=n.data,D(r)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),N.push("/login");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();t()}),[]),(0,i.useEffect)((function(){var e=function(){var e=S(a().mark((function e(){var t,n,r,o,i,u,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c().get("".concat("http://localhost:8082","/api/recordings?populate=audio"));case 2:if(200!==(t=e.sent).status&&N.push("/login"),200===t.status){for(n=[],r=[],o=t.data.data,i=0;i<o.length;i++)if("male"===o[i].attributes.gender)for(u=0;u<o[i].attributes.audio.data.length;u++)r.push(o[i].attributes.audio.data[u]);else if("female"===o[i].attributes.gender)for(s=0;s<o[i].attributes.audio.data.length;s++)n.push(o[i].attributes.audio.data[s]);"male"===(null===Z||void 0===Z?void 0:Z.gender)&&(v(r),d(r[0])),"female"===(null===Z||void 0===Z?void 0:Z.gender)&&(v(n),d(n[0])),w(0)}case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[Z]),(0,i.useEffect)((function(){h.length>0&&!R?U(setTimeout((function(){d(h[b+1]),w((function(e){return e+1}))}),6e4)):clearTimeout(E)}),[h,R]),(0,r.jsxs)("div",{className:s.fileUpload,children:[(0,r.jsxs)(x.Z,{sx:{padding:"20px 80px",backgroundColor:"#e3e3e3",display:"flex",flexDirection:"column"},children:[(0,r.jsx)(y.Z,{textAlign:"center",variant:"h4",children:"Server's audio"}),(0,r.jsxs)(y.Z,{variant:"subtitle1",textAlign:"center",children:["Playing gender ",null===Z||void 0===Z?void 0:Z.gender]}),(0,r.jsx)("br",{}),h.length>0&&(0,r.jsx)("audio",{controls:"controls",src:"".concat("http://localhost:8082").concat(null===l||void 0===l||null===(e=l.attributes)||void 0===e?void 0:e.url)})]}),(0,r.jsx)(x.Z,{sx:{padding:"10px 80px"},children:(0,r.jsxs)("form",{onSubmit:P,style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,r.jsx)(y.Z,{textAlign:"center",children:"User Audio"}),(0,r.jsx)(m,{setAudio:o,setIsRecordingStart:k}),(0,r.jsx)(p.Z,{type:"submit",variant:"outlined",children:"Submit"})]})})]})};function j(){return(0,r.jsx)(w,{})}},7120:function(e){e.exports={center:"FileUpload_center__QYMnO",fileUpload:"FileUpload_fileUpload__nGAzr"}},1403:function(e){e.exports={Recorder:"Recorder_Recorder__E9Dt5","Recorder-logo":"Recorder_Recorder-logo__fkK2b","App-logo-spin":"Recorder_App-logo-spin__huyQR","Recorder-link":"Recorder_Recorder-link__c6VCL",header:"Recorder_header__ZsXEQ"}}},function(e){e.O(0,[321,230,400,774,888,179],(function(){return t=8946,e(e.s=t);var t}));var t=e.O();_N_E=t}]);